---
published: true
type: tech
topics:
  - traccar
emoji: ğŸ”„
title: Traccarã®ãƒ‡ãƒ¼ã‚¿ã‚’H2ã‹ã‚‰MySQLã«ç§»è¡Œ
---

# æ¦‚è¦
[Traccar](https://www.traccar.org/)ã‚’5.9ã«ã‚¢ãƒ—ãƒ‡ã—ãŸã‚‰èµ·å‹•ã—ãªããªã£ãŸã€‚ã©ã†ã‚„ã‚‰ä»Šã¾ã§ã®å†…éƒ¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å½¢å¼ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œãªããªã£ãŸã¿ãŸã„ã§ã™ã€‚

https://github.com/traccar/traccar/issues/5164

ã“ã‚Œã‚’æ©Ÿã«MySQLã«ç§»è¡Œã—ã‚ˆã†ã¨ã„ã†è¨˜äº‹ã§ã™ã€‚

# MySQLã®å°å…¥
traccarã®ã‚µãƒ¼ãƒãƒ¼ã¯docker-compose.ymlã§ç®¡ç†ã—ã¦ã„ã‚‹ã®ã§ãã“ã«mysqlã‚’è¿½åŠ ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã®ãŸã‚ã«ä¸€æ™‚çš„ã«portsã‚’è¨­å®šã—ã¾ã™ã€‚
```yaml:docker-compose.yml
  db:
    image: mysql:latest
    environment:
      MYSQL_ROOT_PASSWORD: mysql
      MYSQL_DATABASE: db
      MYSQL_USER: user
      MYSQL_PASSWORD: password
    ports:
      - "3306:3306"
    volumes:
      - ./db/data:/var/lib/mysql
      - ./db/logs:/var/log/mysql
```
æ¬¡ã«`traccar.xml`ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šã‚’æ›¸ãæ›ãˆã¾ã™ã€‚
å‚è€ƒ:

https://www.traccar.org/mysql/

```xml:traccar.xmlã®ä¸€éƒ¨
    <entry key='database.driver'>com.mysql.cj.jdbc.Driver</entry>
    <entry key='database.url'>jdbc:mysql://db/db?zeroDateTimeBehavior=round&amp;serverTimezone=UTC&amp;allowPublicKeyRetrieval=true&amp;useSSL=false&amp;allowMultiQueries=true&amp;autoReconnect=true&amp;useUnicode=yes&amp;characterEncoding=UTF-8&amp;sessionVariables=sql_mode=''</entry>
    <entry key='database.user'>user</entry>
    <entry key='database.password'>password</entry>

```

ã“ã“ã§ä¸€åº¦Traccarã‚’èµ·å‹•ã—ã€MySQLã«ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
ç¢ºèªå¾Œã¯ãƒ‡ãƒ¼ã‚¿ã®ç§»è¡Œã‚’è¡Œã†ãŸã‚ã€Traccarã®ã‚³ãƒ³ãƒ†ãƒŠã¯åœæ­¢ã—ã¦ãŠãã¾ã™ã€‚
# ãƒ‡ãƒ¼ã‚¿ã®ç§»è¡Œ
æ¬¡ã«å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’ç§»è¡Œã—ã¾ã™ã€‚ã“ã®ãƒ¡ãƒ¢ã‚’æ›¸ãéš›ã«è‰²ã€…è©¦ã—ã¦ã¿ã¾ã—ãŸãŒã€[DBeaver](https://dbeaver.io/)ã‚’ä½¿ã†ã¨ä¸€ç•ªç°¡å˜ã ã£ãŸã®ã§ã“ã‚Œã‚’ä½¿ã†ã“ã¨ã«ã—ã¾ã—ãŸã€‚ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚¨ã‚¢ã§ã‚‚ä¸€å¿œã§ãã‚‹ã¿ãŸã„ã§ã¯ã‚ã‚‹ã‚ˆã†ã§ã™ã€‚
å‚è€ƒ:

https://www.traccar.org/forums/topic/suggestions-for-a-good-migration-tool-to-convert-h2-to-mysql/

## æ‰‹é †
### 1. H2ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨MySQLã«æ¥ç¶š
DBeaverã‚’é–‹ãã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¾ã™ã€‚H2ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯dockerã§ã‚ã‚Œã°ãƒœãƒªãƒ¥ãƒ¼ãƒ å†…ã®ã©ã“ã‹ã«`database.mv.db`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã¯ãšã€‚å¤šåˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ãŠã„ãŸã»ã†ãŒã„ã„ã§ã™ã€‚æ¥ç¶šã™ã‚‹éš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ¼ãƒ ã¯ä»Šã¾ã§ã®`traccar.xml`ã«æ›¸ã„ã¦ã‚ã‚‹ã¯ãšã§ã™ã€‚
åŒæ§˜ã«æ–°ã—ã„MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚‚æ¥ç¶šã—ã¾ã™ã€‚

### 2. ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
DBeaverã§ã¯ä»–ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã¨ã„ã†æ©Ÿèƒ½ãŒã‚ã‚Šã€ä»Šå›ã¯ã“ã‚Œã‚’ä½¿ã†ã“ã¨ã§ç°¡å˜ã«ãƒ‡ãƒ¼ã‚¿ã‚’ç§»è¡Œã§ãã¾ã—ãŸã€‚
ã¾ãšã€H2ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰`DATABASECHANGELOG`ã¨`DATABASECHANGELOGLOCK`ã‚’é™¤ã„ãŸå…¨ã¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã—ã¦å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’é¸æŠã€‚

ãã®å¾Œå‡ºã¦ãã‚‹ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã«å¾“ã„é€²ã‚ã¾ã™ã€‚

:::message
H2ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒå‹•ã„ã¦ãŸã¨ãã¨ã¨MySQLã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ãŸtraccarã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆã£ã¦ã„ãªã„ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç§»è¡ŒãŒã†ã¾ãã„ã‹ãªã„ã¨æ€ã‚ã‚Œã¾ã™
:::
![](/images/blog/2023/09/traccar/t1.png)
Export targetã§ã¯ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ã‚’é¸æŠã—æ¬¡ã¸
![](/images/blog/2023/09/traccar/t3.png)
æ¬¡ã®ç”»é¢ã§`Choose...`ã‚ˆã‚ŠMySQLã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é¸æŠã™ã‚‹ã€‚ã™ã‚‹ã¨è‡ªå‹•ã§æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«insertã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ãã‚Œã¾ã™ã€‚

ãã®ã¾ã¾æ¬¡ã¸ã¨é€²ã¿ã€æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã‚’ã—ã¦ã‹ã‚‰ã€Œç¶šè¡Œã€ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒç§»è¡Œã•ã‚Œã¾ã™ã€‚

:::message
è‡ªåˆ†ã®å ´åˆã€`tc_servers`ã¨ã„ã†ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç§»è¡Œã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€‚ç§»è¡Œå…ƒã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚1ä»¶ã—ã‹å…¥ã£ã¦ãŠã‚‰ãšã‚ã¾ã‚Šé‡è¦ãªãƒ‡ãƒ¼ã‚¿ã§ã‚‚ç„¡ã•ãã†ã ã£ãŸã®ã§è‡ªåˆ†ã¯ç§»è¡Œã—ãªã„ã§ãã®ã¾ã¾ã«ã—ã¦ãŠãã“ã¨ã«ã—ã¾ã—ãŸãŒäººã«ã‚ˆã£ã¦ã¯æ‰‹å‹•ã§è‰²ã€…ã¨ä½œæ¥­ã‚’ã—ãªã‘ã‚Œã°ã„ã‘ãªã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚
:::

### 3. ç¢ºèª
TraccarãŒæ­£å¸¸ã«èµ·å‹•ã—ã€ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªã—ãŸã‚‰å®Œäº†ã€‚

# ã‚ã¨ãŒã
ä¸€å¿œè‡ªåˆ†ã¯ã“ã®æ–¹æ³•ã§ãƒ‡ãƒ¼ã‚¿ã‚’ç§»è¡Œã§ãã¾ã—ãŸãŒã“ã‚Œã‹ã‚‰ä½¿ã£ã¦ã„ãã†ã¡ã«ä½•ã‹ã‚¨ãƒ©ãƒ¼ãªã©ãŒå‡ºå§‹ã‚ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã—ã‚‚ã£ã¨å¤§ãã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®ç§»è¡Œã ã¨å¤±æ•—ã™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚

H2ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ä»Šå›ã®ã‚ˆã†ã«æ€¥ã«å£Šã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§H2ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§traccarã‚’é‹ç”¨ã—ã¦ã„ã‚‹äººã¯ãƒ‡ãƒ¼ã‚¿ãŒå°ã•ã„ã†ã¡ã«ç§»è¡Œã—ã¦ãŠã„ãŸã»ã†ãŒã„ã„ã‹ã‚‚ã€‚


> ã“ã®è¨˜äº‹ã¯ [https://note.nazo6.dev/blog/traccer-h2-to-mysql](https://note.nazo6.dev/blog/traccer-h2-to-mysql) ã¨ã®ã‚¯ãƒ­ã‚¹ãƒã‚¹ãƒˆã§ã™ã€‚